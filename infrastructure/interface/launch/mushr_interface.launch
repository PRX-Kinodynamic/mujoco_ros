<launch>
    <arg name="simulation" default="true" />
    <arg name="ground_truth_pose_used" default="false" />
    <arg name="plan_translate_topic" default="/mushr/ml4kp_plan" />
    <arg name="plan_stepper_topic" default="/mushr/plan_stepper/control" />

    <group ns="mushr">
        <node pkg="nodelet" type="nodelet" name="mushr_interface_manager"  args="manager" output="screen"/>

         <node pkg="nodelet" type="nodelet" name="plan_stepper_t" 
            args="load ml4kp_bridge/plan_stepper_t mushr_interface_manager" 
            output="screen">
            <param name="subscriber_topic" value="$(arg plan_translate_topic)" />
            <param name="publisher_topic" value="$(arg plan_stepper_topic)"/>
            <param name="frequency" value="100" />
        </node>    

        <node if="$(arg simulation)" pkg="nodelet" type="nodelet" name="MushrFromSpacePointNodelet" 
            args="load interface/MushrFromSpacePointNodelet mushr_interface_manager" 
            output="screen">
            <param name="subscriber_topic" value="$(arg plan_stepper_topic)" />
            <param name="publisher_topic" value="/mushr/control" />
            <param name="frequency" value="100" />
        </node>         

        <node unless="$(arg simulation)" pkg="nodelet" type="nodelet" name="AckermannFromSpacePointNodelet" 
            args="load interface/AckermannFromSpacePointNodelet mushr_interface_manager" 
            output="screen">
            <param name="publisher_topic" value="/mushr/mux/ackermann_cmd_mux/output" />
            <param name="subscriber_topic" value="$(arg plan_stepper_topic)" />
            <param name="frequency" value="100" />
        </node>   

        <node if="$(arg ground_truth_pose_used)" pkg="nodelet" type="nodelet" name="GroundTruthPoseNodelet"  
            args="load interface/GroundTruthPoseNodelet mushr_interface_manager"  
            output="screen">
            <param name="publisher_topic" value="/mushr/pose" />
            <param name="subscriber_topic" value="/mushr/sensordata" />
            <param name="frequency" value="15" />
        </node>

        <node unless="$(arg ground_truth_pose_used)" pkg="nodelet" type="nodelet" name="plant_estimator_nodelet_t" 
            args="load interface/MushrObservationFromArucoNodelet mushr_interface_manager" output="screen">
            <param name="world_frame" value="world"/>
            <param name="robot_frame" value="robot_0"/>
            <param name="observation_topic" value="/mushr/pose" />
		</node>   
    </group>
  
</launch>